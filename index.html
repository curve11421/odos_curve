<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ODOS Student Management System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap');
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #FEFDF7;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: auto;
        }
        .header {
            background-color: #F8D442;
            padding: 15px 30px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
        }
        .header h1 { margin: 0; font-size: 24px; color: #333; }
        .header p { margin: 5px 0 0; font-size: 16px; }
        .card {
            background-color: #FFFFFF;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #E0E0E0;
            margin-bottom: 20px;
        }
        
        /* ปรับสไตล์ให้ฟอร์มและปุ่มอยู่คู่กัน */
        .search-form-container {
            display: flex;
            gap: 20px;
        }
        
        .search-students {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .search-row {
            display: grid;
            grid-template-columns: 150px 300px; /* ลดขนาดช่อง input */
            gap: 15px;
            align-items: center;
            padding: 15px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            background-color: #FAFAFA;
        }
        
        .search-row label {
            font-weight: bold;
            color: #555;
        }
        
        .search-row input {
            padding: 10px;
            border: 1px solid #CCC;
            border-radius: 4px;
            font-size: 16px;
            width: 100%;
        }
        
        /* ปรับสไตล์ปุ่มให้อยู่ทางขวาและเรียงตัวในแนวตั้ง */
        .control-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 200px;
            align-self: flex-start;
            margin-top: 0;
        }
        
        .btn { 
            padding: 15px 20px; 
            border: none; 
            border-radius: 8px; 
            font-size: 16px; 
            cursor: pointer; 
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s;
            width: 100%;
            text-align: center;
        }
        
        .btn-clear { 
            background-color: #E0E0E0; 
            color: #333; 
        }
        
        .btn-clear:hover {
            background-color: #D0D0D0;
        }
        
        .btn-search-all {
            background-color: #F8D442;
            color: #333;
        }
        
        .btn-search-all:hover {
            background-color: #F5D020;
        }
        
        .btn-search-all:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .btn-approve-all { 
            background-color: #4CAF50; 
            color: white; 
        }
        
        .btn-approve-all:hover {
            background-color: #45A049;
        }
        
        .btn-approve-all:disabled { 
            background-color: #cccccc; 
            cursor: not-allowed; 
        }
        
        .loading, .message { text-align: center; padding: 20px; font-size: 18px; }
        
        /* เพิ่มสไตล์สำหรับแสดงจำนวนผลการค้นหา */
        .search-results-info {
            background-color: #E3F2FD;
            border: 1px solid #2196F3;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
            color: #1976D2;
        }
        .search-results-warning {
            background-color: #FFF3E0;
            border: 1px solid #FF9800;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
            color: #F57C00;
        }
        .search-results-error {
            background-color: #FFEBEE;
            border: 1px solid #F44336;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
            color: #D32F2F;
        }

        /* Styles for Multiple Student Cards */
        .student-list-container {
            display: flex;
            flex-wrap: nowrap;
            gap: 15px;
            justify-content: flex-start;
            margin-top: 20px;
            overflow-x: auto;
            padding: 10px 0;
        }
        .student-card-wrapper { 
            flex-shrink: 0; 
            transition: all 0.3s ease;
        }
        .student-card-wrapper.removing {
            opacity: 0;
            transform: scale(0.8);
        }
        .student-card {
            width: 280px; padding: 15px; background-color: #FEFDF7;
            border: 1px solid #E0E0E0; border-radius: 8px;
            display: flex; flex-direction: column; align-items: center;
        }
        .student-card.highlight-na {
            border: 2px solid #F44336;
            background-color: #FFEBEE;
            box-shadow: 0 2px 8px rgba(244, 67, 54, 0.3);
        }
        .student-card.highlight-na .eng-name {
            color: #D32F2F;
        }
        .student-card.approved {
            border: 2px solid #4CAF50;
            background-color: #E8F5E8;
        }
        .student-card.disapproved {
            border: 2px solid #F44336;
            background-color: #FFEBEE;
        }
        .na-indicator {
            background-color: #F44336;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .approved-indicator {
            background-color: #4CAF50;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .disapproved-indicator {
            background-color: #F44336;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .student-card .profile-pic img {
            width: 100px; height: 100px; border-radius: 50%;
            object-fit: cover; border: 2px solid #F8D442; margin-bottom: 15px;
        }
        .student-card .eng-name { font-size: 18px; font-weight: bold; }
        .student-card .country { font-size: 14px; color: #666; margin-bottom: 20px; }
        .student-details { width: 100%; font-size: 14px; }
        .student-details .detail-row { display: grid; grid-template-columns: 100px 1fr; margin-bottom: 8px; }
        .student-details .detail-row span:first-child { font-weight: bold; color: #555; }
        .student-card textarea {
            width: calc(100% - 22px); height: 60px; margin-top: 20px; padding: 10px;
            border-radius: 4px; border: 1px solid #CCC; resize: vertical;
        }
        .student-card .action-buttons { display: flex; justify-content: space-between; width: 100%; margin-top: 15px; }
        .btn-action { width: 48%; padding: 10px; }
        .btn-approve { background-color: #4CAF50; color: white; }
        .btn-disapprove { background-color: #F44336; color: white; }
        .btn-action:disabled { background-color: #cccccc; cursor: not-allowed; }

        /* เพิ่ม Animation สำหรับการหายไป */
        @keyframes fadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.8); }
        }
        
        .fade-out {
            animation: fadeOut 0.3s ease forwards;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .search-form-container {
                flex-direction: column;
            }
            
            .control-buttons {
                width: 100%;
                flex-direction: row;
                justify-content: space-around;
            }
            
            .search-row {
                grid-template-columns: 120px 1fr;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>ODOS Student Management System</h1>
            <p>Department of Digital Economy Promotion (depa)</p>
        </div>

        <div class="card">
            <div class="search-form-container">
                <div class="search-students">
                    <div class="search-row">
                        <label for="studentId1">Student ID #1:</label>
                        <input type="text" id="studentId1" placeholder="Enter Student ID">
                    </div>
                    
                    <div class="search-row">
                        <label for="studentId2">Student ID #2:</label>
                        <input type="text" id="studentId2" placeholder="Enter Student ID">
                    </div>
                    
                    <div class="search-row">
                        <label for="studentId3">Student ID #3:</label>
                        <input type="text" id="studentId3" placeholder="Enter Student ID">
                    </div>
                    
                    <div class="search-row">
                        <label for="studentId4">Student ID #4:</label>
                        <input type="text" id="studentId4" placeholder="Enter Student ID">
                    </div>
                    
                    <div class="search-row">
                        <label for="studentId5">Student ID #5:</label>
                        <input type="text" id="studentId5" placeholder="Enter Student ID">
                    </div>
                </div>
                
                <div class="control-buttons">
                    <button class="btn btn-clear" onclick="clearAll()">Clear All</button>
                    <button class="btn btn-search-all" onclick="searchAllFields()">Search All</button>
                    <button class="btn btn-approve-all" id="approveAllBtn">Approve All</button>
                </div>
            </div>
        </div>

        <div class="loading" id="loading" style="display: none;">Searching...</div>
        
        <!-- เพิ่มส่วนแสดงข้อมูลผลการค้นหา -->
        <div id="searchResultsInfo" style="display: none;"></div>
        
        <div id="studentListContainer" class="student-list-container"></div>
    </div>

    <template id="studentCardTemplate">
        <div class="student-card-wrapper">
            <div class="student-card">
                <div class="profile-pic">
                    <img class="profile-image" src="" alt="Profile Picture">
                </div>
                <div class="eng-name"></div>
                <div class="country"></div>

                <div class="student-details">
                    <div class="detail-row"><span>ID:</span><span class="info-id"></span></div>
                    <div class="detail-row"><span>Thai Name:</span><span class="info-thai-name"></span></div>
                    <div class="detail-row"><span>Birth Date:</span><span class="info-birth-date"></span></div>
                    <div class="detail-row"><span>Age:</span><span class="info-age"></span></div>
                    <div class="detail-row"><span>Province:</span><span class="info-province"></span></div>
                    <div class="detail-row"><span>GPA:</span><span class="info-gpa"></span></div>
                    <div class="detail-row"><span>EnglishGPA:</span><span class="info-EnglishGPA"></span></div>
                    <div class="detail-row"><span>Study Status:</span><span class="info-study-status"></span></div>
                </div>

                <textarea class="comments-textarea" placeholder="Add your comments here"></textarea>
                <div class="action-buttons">
                    <button class="btn btn-action btn-approve">Approve</button>
                    <button class="btn btn-action btn-disapprove">Disapprove</button>
                </div>
            </div>
        </div>
    </template>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx7U7J5GBg2KOYHsCoG7FGl1A12dBYVZsjHy-SznWYv0GTFHeoqblhO8jnQjPT_8uX31g/exec";
        const MAX_STUDENTS = 5;
        let currentStudents = new Map();
        let studentCardElements = new Map(); // เก็บ reference ของ card element

        const loadingDiv = document.getElementById('loading');
        const studentListContainer = document.getElementById('studentListContainer');
        const searchResultsInfo = document.getElementById('searchResultsInfo');
        const approveAllBtn = document.getElementById('approveAllBtn');

        // เพิ่ม event listener สำหรับปุ่ม Approve All
        approveAllBtn.addEventListener('click', approveAllStudents);

        // เพิ่ม event listener สำหรับการกด Enter ในแต่ละช่อง
        for (let i = 1; i <= 5; i++) {
            const input = document.getElementById(`studentId${i}`);
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    searchAllFields();
                }
            });
        }

        function clearAll() {
            // Clear all input fields
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`studentId${i}`).value = '';
            }
            
            // Clear all displayed students
            currentStudents.clear();
            studentCardElements.clear();
            studentListContainer.innerHTML = '';
            searchResultsInfo.style.display = 'none';
        }

        function disableSearchInputs(disabled) {
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`studentId${i}`).disabled = disabled;
            }
            document.querySelector('.btn-search-all').disabled = disabled;
        }

        function searchAllFields() {
            const fieldsToSearch = [];
            
            // เช็ค Student ID fields
            for (let i = 1; i <= 5; i++) {
                const value = document.getElementById(`studentId${i}`).value.trim();
                if (value) {
                    fieldsToSearch.push({key: 'studentID', value: value});
                }
            }
            
            if (fieldsToSearch.length === 0) {
                alert('Please enter at least one Student ID.');
                return;
            }
            
            if (currentStudents.size >= MAX_STUDENTS) {
                showMessage('Maximum 5 students can be displayed at once. Please clear some students first.', 'error');
                return;
            }

            // ค้นหาแบบพร้อมกัน
            searchMultipleStudents(fieldsToSearch);
        }

        function searchMultipleStudents(fieldsToSearch) {
            loadingDiv.style.display = 'block';
            disableSearchInputs(true);
            
            const searchPromises = fieldsToSearch.map(field => {
                return fetch(`${SCRIPT_URL}?key=${field.key}&value=${encodeURIComponent(field.value)}`)
                    .then(response => response.json())
                    .then(res => {
                        if (res.data && res.data.length > 0) {
                            return res.data;
                        }
                        return [];
                    })
                    .catch(error => {
                        console.error(`Error searching for ${field.key}:`, error);
                        return [];
                    });
            });

            Promise.all(searchPromises)
                .then(results => {
                    // รวมผลลัพธ์จากการค้นหาทั้งหมด
                    const allStudents = [];
                    results.forEach(studentList => {
                        allStudents.push(...studentList);
                    });
                    
                    if (allStudents.length > 0) {
                        addStudentsToList(allStudents);
                    } else {
                        showMessage('No students found.', 'error');
                    }
                })
                .finally(() => {
                    loadingDiv.style.display = 'none';
                    disableSearchInputs(false);
                });
        }

        function searchStudentById(inputId) {
            const input = document.getElementById(inputId);
            const value = input.value.trim();
            if (value) {
                searchStudent('studentID', value);
            } else {
                alert('Please enter a Student ID to search.');
            }
        }

        function removeStudentCard(studentId) {
            const cardElement = studentCardElements.get(studentId);
            if (cardElement) {
                // เพิ่ม animation fade out
                cardElement.classList.add('fade-out');
                
                // หลังจาก animation เสร็จแล้วค่อยลบออกจาก DOM
                setTimeout(() => {
                    cardElement.remove();
                    currentStudents.delete(studentId);
                    studentCardElements.delete(studentId);
                    
                    // อัพเดตข้อมูลจำนวนนักเรียนที่แสดง
                    updateStudentCountDisplay();
                }, 300);
            }
        }

        function updateStudentCountDisplay() {
            if (currentStudents.size === 0) {
                searchResultsInfo.style.display = 'none';
            } else {
                showMessage(`Total: ${currentStudents.size}/${MAX_STUDENTS} students displayed.`, 'info');
            }
        }

        function approveAllStudents() {
            if (currentStudents.size === 0) {
                alert('No students to approve.');
                return;
            }

            if (!confirm(`Are you sure you want to approve all ${currentStudents.size} students?`)) {
                return;
            }

            approveAllBtn.disabled = true;
            approveAllBtn.textContent = 'Approving...';
            
            let approvalPromises = [];
            let approvedCount = 0;
            let studentsToRemove = [];

            currentStudents.forEach((student, studentId) => {
                const cardElement = studentCardElements.get(studentId);
                if (!cardElement) return;

                const commentsTextarea = cardElement.querySelector('.comments-textarea');
                const approveBtn = cardElement.querySelector('.btn-approve');
                const disapproveBtn = cardElement.querySelector('.btn-disapprove');
                
                // Skip if already approved/disapproved
                if (approveBtn.disabled) return;

                const comment = commentsTextarea.value || 'Bulk approved';
                
                const dataToPost = {
                    studentID: studentId,
                    comment: comment,
                    status: 'Approve'
                };

                // Disable buttons immediately
                approveBtn.disabled = true;
                disapproveBtn.disabled = true;

                const promise = fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify(dataToPost)
                })
                .then(() => {
                    approvedCount++;
                    
                    // เพิ่มนักเรียนเข้าในรายการที่จะลบ
                    studentsToRemove.push(studentId);
                })
                .catch(error => {
                    console.error(`Error approving student ${studentId}:`, error);
                    // Re-enable buttons on error
                    approveBtn.disabled = false;
                    disapproveBtn.disabled = false;
                });

                approvalPromises.push(promise);
            });

            Promise.allSettled(approvalPromises)
                .then(() => {
                    if (approvedCount > 0) {
                        alert(`Successfully approved ${approvedCount} students.`);
                        
                        // ลบนักเรียนที่ได้รับการอนุมัติออกจากหน้าจอ
                        studentsToRemove.forEach(studentId => {
                            setTimeout(() => {
                                removeStudentCard(studentId);
                            }, 500); // ให้เวลาสำหรับ alert ก่อน
                        });
                    }
                })
                .catch(error => {
                    console.error('Error in bulk approval:', error);
                    alert('Some approvals may have failed. Please check individual students.');
                })
                .finally(() => {
                    approveAllBtn.disabled = false;
                    approveAllBtn.textContent = 'Approve All';
                });
        }

        function searchStudent(key, value) {
            if (!value) return;
            
            if (currentStudents.size >= MAX_STUDENTS) {
                showMessage('Maximum 5 students can be displayed at once. Please clear some students first.', 'error');
                return;
            }

            loadingDiv.style.display = 'block';
            disableSearchInputs(true);

            fetch(`${SCRIPT_URL}?key=${key}&value=${encodeURIComponent(value)}`)
                .then(response => response.json())
                .then(res => {
                    if (res.data && res.data.length > 0) {
                        addStudentsToList(res.data);
                    } else {
                        showMessage('Student not found.', 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showMessage('An error occurred while searching.', 'error');
                })
                .finally(() => {
                    loadingDiv.style.display = 'none';
                    disableSearchInputs(false);
                });
        }

        function addStudentsToList(students) {
            let newStudentsAdded = 0;
            let duplicateCount = 0;

            students.forEach(student => {
                const studentId = student['ID'];
                
                if (currentStudents.has(studentId)) {
                    duplicateCount++;
                    return;
                }

                if (currentStudents.size >= MAX_STUDENTS) {
                    return;
                }

                currentStudents.set(studentId, student);
                newStudentsAdded++;
            });

            displayAllStudents();

            let message = '';
            if (newStudentsAdded > 0) {
                message += `Added ${newStudentsAdded} student${newStudentsAdded > 1 ? 's' : ''}. `;
            }
            if (duplicateCount > 0) {
                message += `${duplicateCount} student${duplicateCount > 1 ? 's' : ''} already displayed. `;
            }
            if (currentStudents.size >= MAX_STUDENTS) {
                message += `Maximum ${MAX_STUDENTS} students displayed.`;
            } else {
                message += `Total: ${currentStudents.size}/${MAX_STUDENTS} students displayed.`;
            }

            if (message) {
                const messageType = (newStudentsAdded > 0) ? 'info' : 'warning';
                showMessage(message, messageType);
            }
        }

        function displayAllStudents() {
            const template = document.getElementById('studentCardTemplate');
            studentListContainer.innerHTML = '';
            studentCardElements.clear();

            if (currentStudents.size === 0) {
                return;
            }

            currentStudents.forEach(student => {
                const card = template.content.cloneNode(true);
                
                let hasNAData = false;
                
                card.querySelector('.profile-image').src = student['Image'] || 'https://via.placeholder.com/100';
                card.querySelector('.eng-name').textContent = `${student['English Firstname']} ${student['English Lastname']}`;
                card.querySelector('.country').textContent = student['Country'] || 'N/A';
                card.querySelector('.info-id').textContent = student['ID'];
                card.querySelector('.info-thai-name').textContent = `${student['Thai Firstname']} ${student['Thai Lastname']}`;
                
                const birthDateStr = student['Date of Birth'];
                if (birthDateStr) {
                    const dateParts = birthDateStr.split('/');
                    if (dateParts.length === 3) {
                        const birthDate = new Date(+dateParts[2], dateParts[1] - 1, +dateParts[0]);
                        card.querySelector('.info-birth-date').textContent = birthDate.toLocaleDateString('en-GB');
                        const birthYear = birthDate.getFullYear();
                        if (!isNaN(birthYear)) {
                            card.querySelector('.info-age').textContent = `${2025 - birthYear} years`;
                        }
                    } else {
                         card.querySelector('.info-birth-date').textContent = 'Invalid Date';
                         card.querySelector('.info-age').textContent = 'N/A';
                         hasNAData = true;
                    }
                } else {
                    card.querySelector('.info-birth-date').textContent = 'N/A';
                    card.querySelector('.info-age').textContent = 'N/A';
                    hasNAData = true;
                }
                
                const provinceValue = student['จังหวัดตามทะเบียนบ้าน'] || 'N/A';
                const gpaValue = student['เกรดเฉลี่ยภาคการศึกษาก่อนหน้า (GPA)'] || 'N/A';
                const englishGpaValue = student['เกรดวิชาภาษาอังกฤษเทอมก่อนหน้า'] || 'N/A';
                const studyStatusValue = student['อยู่ระหว่างการศึกษา'] || 'N/A';
                const countryValue = student['Country'] || 'N/A';
                
                if (provinceValue === 'N/A' || gpaValue === 'N/A' || englishGpaValue === 'N/A' || 
                    studyStatusValue === 'N/A' || countryValue === 'N/A') {
                    hasNAData = true;
                }
                
                card.querySelector('.info-province').textContent = provinceValue;
                card.querySelector('.info-gpa').textContent = gpaValue;
                card.querySelector('.info-EnglishGPA').textContent = englishGpaValue;
                card.querySelector('.info-study-status').textContent = studyStatusValue;

                const studentId = student['ID'];
                const approveBtn = card.querySelector('.btn-approve');
                const disapproveBtn = card.querySelector('.btn-disapprove');
                const commentsTextarea = card.querySelector('.comments-textarea');

                approveBtn.addEventListener('click', () => submitDecision(studentId, 'Approve', commentsTextarea.value, approveBtn, disapproveBtn));
                disapproveBtn.addEventListener('click', () => submitDecision(studentId, 'Disapprove', commentsTextarea.value, approveBtn, disapproveBtn));

                studentListContainer.appendChild(card);
                
                // เก็บ reference ของ card element
                const cardElement = studentListContainer.lastElementChild;
                studentCardElements.set(studentId, cardElement);
                
                if (hasNAData) {
                    const cardElemelntInner = cardElement.querySelector('.student-card');
                    cardElementInner.classList.add('highlight-na');
                    
                    const indicator = document.createElement('div');
                    indicator.className = 'na-indicator';
                    indicator.textContent = 'Missing Data';
                    cardElementInner.insertBefore(indicator, cardElementInner.querySelector('.eng-name'));
                }
            });
        }

        function showMessage(message, type = 'info') {
            let className = 'search-results-info';
            if (type === 'warning') className = 'search-results-warning';
            if (type === 'error') className = 'search-results-error';

            searchResultsInfo.innerHTML = `<div class="${className}">${message}</div>`;
            searchResultsInfo.style.display = 'block';
        }

        function submitDecision(studentID, status, comment, approveBtn, disapproveBtn) {
    const dataToPost = {
        studentID: studentID,
        comment: comment,
        status: status
    };
    
    // ปิดการใช้งานปุ่มทันที
    approveBtn.disabled = true;
    disapproveBtn.disabled = true;

    fetch(SCRIPT_URL, {
        method: 'POST',
        // ไม่ต้องใช้ mode: 'no-cors' แล้ว
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(dataToPost)
    })
    .then(response => response.json()) // แปลง response เป็น JSON
    .then(data => {
        // ตรวจสอบ response ที่ได้รับจาก Apps Script
        if (data.success) {
            console.log(data.message); // แสดงข้อความจาก script ใน console
            alert(`Student ID ${studentID} status set to '${status}'.`);
            
            // หลังจากส่งข้อมูลเสร็จแล้ว ให้ลบนักเรียนออกจากหน้าจอ
            setTimeout(() => {
                removeStudentCard(studentID);
            }, 300); // หน่วงเวลาเล็กน้อย
        } else {
            // หากเกิดข้อผิดพลาดจากฝั่ง script
            console.error('Error from script:', data.message);
            alert('An error occurred while submitting the decision: ' + data.message);
            // เปิดใช้งานปุ่มอีกครั้งเพื่อให้ผู้ใช้ลองใหม่
            approveBtn.disabled = false;
            disapproveBtn.disabled = false;
        }
    })
    .catch(error => {
        // หากเกิดข้อผิดพลาดด้านเครือข่าย
        console.error('Network Error:', error);
        alert('A network error occurred. Please check your connection and try again.');
        // เปิดใช้งานปุ่มอีกครั้ง
        approveBtn.disabled = false;
        disapproveBtn.disabled = false;
    });
}
    </script>
</body>
</html>